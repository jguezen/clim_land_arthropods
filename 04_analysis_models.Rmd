---
title: "04. Analysis - Models"
author: Jessica Guezen
output: pdf_document
---

# Set up

Open csv:
```{r}
climate_land_abund = read.csv(
  "~/Desktop/clim_land_arthropods/final_dat.csv")
```

Load packages:
```{r}
library(arm)
library(lme4)
library(glmmTMB)
library(lmerTest)
library(MuMIn)
library(polypoly)
library(psych)
library(performance)
library(see)
library(car)
library(tidyverse)
library(mgcv)
library(insight)
```

```{r}
climate_land_abund <-
  climate_land_abund %>%
  dplyr::select(-X)
```

# Analysis

## Correlations

```{r}
ggplot(data = climate_land_abund, aes(x = change3_MAT, y = present3_MAT)) +
  geom_point() +
  geom_smooth(method = "lm")
cor.test(climate_land_abund$change3_MAT, climate_land_abund$present3_MAT)
```

```{r}
ggplot(data = climate_land_abund, aes(x = change3_VAT, y = present3_VAT)) +
  geom_point() +
  geom_smooth(method = "lm")
cor.test(climate_land_abund$change3_VAT, climate_land_abund$present3_VAT)
```

```{r}
ggplot(data = climate_land_abund, aes(x = change3_VAT, y = change3_MAT)) +
  geom_point() +
  geom_smooth(method = "lm")
cor.test(climate_land_abund$change3_VAT, climate_land_abund$change3_MAT)
```

## 01. All arthropods (total_abund, Pollinator_study)

### Data frames

100 m:
```{r}
climate_land_abund_01_100 <-
  climate_land_abund %>%
  dplyr::select(
    total_abund,
    sampling_effort_scaled,
    semifor_100,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_01 = total_abund,
    semifor_l = semifor_100
  )
```

250 m:
```{r}
climate_land_abund_01_250 <-
  climate_land_abund %>%
  dplyr::select(
    total_abund,
    sampling_effort_scaled,
    semifor_250,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_01 = total_abund,
    semifor_l = semifor_250
  )
```

500 m:
```{r}
climate_land_abund_01_500 <-
  climate_land_abund %>%
  dplyr::select(
    total_abund,
    sampling_effort_scaled,
    semifor_500,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_01 = total_abund,
    semifor_l = semifor_500
  )
```

1000 m:
```{r}
climate_land_abund_01_1000 <-
  climate_land_abund %>%
  dplyr::select(
    total_abund,
    sampling_effort_scaled,
    semifor_1000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_01 = total_abund,
    semifor_l = semifor_1000
  )
```

2000 m:
```{r}
climate_land_abund_01_2000 <-
  climate_land_abund %>%
  dplyr::select(
    total_abund,
    sampling_effort_scaled,
    semifor_2000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_01 = total_abund,
    semifor_l = semifor_2000
  )
```

3000 m:
```{r}
climate_land_abund_01_3000 <-
  climate_land_abund %>%
  dplyr::select(
    total_abund,
    sampling_effort_scaled,
    semifor_3000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_01 = total_abund,
    semifor_l = semifor_3000
  )
```

### Models

#### 100 m
```{r}
mod1_01_100 <- glmmTMB(
  abund_01 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT)  + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_01_100,
  na.action = "na.fail"
)
check_singularity(mod1_01_100)
check_collinearity(mod1_01_100)
summary(mod1_01_100)
```

#### 250 m
```{r}
mod1_01_250 <- glmmTMB(
  abund_01 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT)  + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_01_250,
  na.action = "na.fail"
)
check_singularity(mod1_01_250)
check_collinearity(mod1_01_250)
summary(mod1_01_250)
```

#### 500 m
```{r}
mod1_01_500 <- glmmTMB(
  abund_01 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT)  + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_01_500,
  na.action = "na.fail"
)
check_singularity(mod1_01_500)
check_collinearity(mod1_01_500)
summary(mod1_01_500)
modnull_01_500 <- glmmTMB(
  abund_01 ~
    1 + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_01_500,
  na.action = "na.fail"
)
model.sel(mod1_01_500, modnull_01_500)
```

#### 1000 m
```{r}
mod1_01_1000 <- glmmTMB(
  abund_01 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT)  + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_01_1000,
  na.action = "na.fail"
)
check_singularity(mod1_01_1000)
check_collinearity(mod1_01_1000)
summary(mod1_01_1000)
```

#### 2000 m
```{r}
mod1_01_2000 <- glmmTMB(
  abund_01 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT)  + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_01_2000,
  na.action = "na.fail"
)
check_singularity(mod1_01_2000)
check_collinearity(mod1_01_2000)
summary(mod1_01_2000)
```

#### 3000 m
```{r}
mod1_01_3000 <- glmmTMB(
  abund_01 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT)  + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_01_3000,
  na.action = "na.fail"
)
check_singularity(mod1_01_3000)
check_collinearity(mod1_01_3000)
summary(mod1_01_3000)
```

### Confidence intervals

```{r}
#100 m:
ci_mod1_01_100 <-
  confint(mod1_01_100)

#250 m:
ci_mod1_01_250 <-
  confint(mod1_01_250)

#500 m:
ci_mod1_01_500 <-
  confint(mod1_01_500)

#1000 m:
ci_mod1_01_1000 <-
  confint(mod1_01_1000)

#2000 m:
ci_mod1_01_2000 <-
  confint(mod1_01_2000)

#3000 m:
ci_mod1_01_3000 <-
  confint(mod1_01_3000)
```

### All scales CI Table

```{r}
#100 m:
ci_mod1_01_100 <-
  ci_mod1_01_100 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_01_100 <- ci_mod1_01_100 %>% rownames_to_column(var = "term")

citable_01_100 <-
  ci_mod1_01_100 %>%
  rename(
    "Estimate_100" = "Estimate",
    "CI_100_2.5" = "2.5 %",
    "CI_100_97.5" = "97.5 %")

#250 m:
ci_mod1_01_250 <-
  ci_mod1_01_250 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_01_250 <- ci_mod1_01_250 %>% rownames_to_column(var = "term")

citable_01_250 <-
  ci_mod1_01_250 %>%
  rename(
    "Estimate_250" = "Estimate",
    "CI_250_2.5" = "2.5 %",
    "CI_250_97.5" = "97.5 %")

#500 m:
ci_mod1_01_500 <-
  ci_mod1_01_500 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_01_500 <- ci_mod1_01_500 %>% rownames_to_column(var = "term")

citable_01_500 <-
  ci_mod1_01_500 %>%
  rename(
    "Estimate_500" = "Estimate",
    "CI_500_2.5" = "2.5 %",
    "CI_500_97.5" = "97.5 %")

#1000 m:
ci_mod1_01_1000 <-
  ci_mod1_01_1000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_01_1000 <- ci_mod1_01_1000 %>% rownames_to_column(var = "term")

citable_01_1000 <-
  ci_mod1_01_1000 %>%
  rename(
    "Estimate_1000" = "Estimate",
    "CI_1000_2.5" = "2.5 %",
    "CI_1000_97.5" = "97.5 %")

#2000 m:
ci_mod1_01_2000 <-
  ci_mod1_01_2000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_01_2000 <- ci_mod1_01_2000 %>% rownames_to_column(var = "term")

citable_01_2000 <-
  ci_mod1_01_2000 %>%
  rename(
    "Estimate_2000" = "Estimate",
    "CI_2000_2.5" = "2.5 %",
         "CI_2000_97.5" = "97.5 %")

#3000 m:
ci_mod1_01_3000 <-
  ci_mod1_01_3000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_01_3000 <- ci_mod1_01_3000 %>% rownames_to_column(var = "term")

citable_01_3000 <-
  ci_mod1_01_3000 %>%
  rename(
    "Estimate_3000" = "Estimate",
    "CI_3000_2.5" = "2.5 %",
         "CI_3000_97.5" = "97.5 %")

#All scales:
citable_01 <- full_join(citable_01_100,
                        citable_01_250,
                        by = c("term", "model"))
citable_01 <- full_join(citable_01,
                        citable_01_500,
                        by = c("term", "model"))
citable_01 <- full_join(citable_01,
                        citable_01_1000,
                        by = c("term", "model"))
citable_01 <- full_join(citable_01,
                        citable_01_2000,
                        by = c("term", "model"))
citable_01 <- full_join(citable_01,
                        citable_01_3000,
                        by = c("term", "model"))

citable_01 <- citable_01 %>%
  filter(!grepl('.sig|(Intercept)', term))

write.csv(citable_01, "~/Desktop/clim_land_arthropods/citable_01.csv")
```

## 05. Diet generalist pollinators (ts_poll_01_abund, Pollinator_study)

### Data frames

100 m:
```{r}
climate_land_abund_05_100 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_01_abund,
    sampling_effort_scaled,
    semifor_100,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_05 = ts_poll_01_abund,
    semifor_l = semifor_100
  )
```

250 m:
```{r}
climate_land_abund_05_250 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_01_abund,
    sampling_effort_scaled,
    semifor_250,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_05 = ts_poll_01_abund,
    semifor_l = semifor_250
  )
```

500 m:
```{r}
climate_land_abund_05_500 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_01_abund,
    sampling_effort_scaled,
    semifor_500,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_05 = ts_poll_01_abund,
    semifor_l = semifor_500
  )
```

1000 m:
```{r}
climate_land_abund_05_1000 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_01_abund,
    sampling_effort_scaled,
    semifor_1000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_05 = ts_poll_01_abund,
    semifor_l = semifor_1000
  )
```

2000 m:
```{r}
climate_land_abund_05_2000 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_01_abund,
    sampling_effort_scaled,
    semifor_2000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_05 = ts_poll_01_abund,
    semifor_l = semifor_2000
  )
```

3000 m:
```{r}
climate_land_abund_05_3000 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_01_abund,
    sampling_effort_scaled,
    semifor_3000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_05 = ts_poll_01_abund,
    semifor_l = semifor_3000
  )
```

### Models

#### 100 m
```{r}
mod1_05_100 <- glmmTMB(
  abund_05 ~
    scale(semifor_l) * scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_05_100,
  na.action = "na.fail"
)
check_singularity(mod1_05_100)
check_collinearity(mod1_05_100)
summary(mod1_05_100)
```

#### 250 m
```{r}
mod1_05_250 <- glmmTMB(
  abund_05 ~
    scale(semifor_l) * scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_05_250,
  na.action = "na.fail"
)
check_singularity(mod1_05_250)
check_collinearity(mod1_05_250)
summary(mod1_05_250)
```

#### 500 m
```{r}
mod1_05_500 <- glmmTMB(
  abund_05 ~
    scale(semifor_l) * scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_05_500,
  na.action = "na.fail"
)
check_singularity(mod1_05_500)
check_collinearity(mod1_05_500)
summary(mod1_05_500)
```

#### 1000 m
```{r}
mod1_05_1000 <- glmmTMB(
  abund_05 ~
    scale(semifor_l) * scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_05_1000,
  na.action = "na.fail"
)
check_singularity(mod1_05_1000)
check_collinearity(mod1_05_1000)
summary(mod1_05_1000)
modnull_05_1000 <- glmmTMB(
  abund_05 ~
    1 + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_05_1000,
  na.action = "na.fail"
)
model.sel(mod1_05_1000, modnull_05_1000)
```


#### 2000 m
```{r}
mod1_05_2000 <- glmmTMB(
  abund_05 ~
    scale(semifor_l) * scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_05_2000,
  na.action = "na.fail"
)
check_singularity(mod1_05_2000)
check_collinearity(mod1_05_2000)
summary(mod1_05_2000)
```

#### 3000 m
```{r}
mod1_05_3000 <- glmmTMB(
  abund_05 ~
    scale(semifor_l) * scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_05_3000,
  na.action = "na.fail"
)
check_singularity(mod1_05_3000)
check_collinearity(mod1_05_3000)
summary(mod1_05_3000)
```

### Confidence intervals

```{r}
#100 m:
ci_mod1_05_100 <-
  confint(mod1_05_100)

#250 m:
ci_mod1_05_250 <-
  confint(mod1_05_250)

#500 m:
ci_mod1_05_500 <-
  confint(mod1_05_500)

#1000 m:
ci_mod1_05_1000 <-
  confint(mod1_05_1000)

#2000 m:
ci_mod1_05_2000 <-
  confint(mod1_05_2000)

#3000 m:
ci_mod1_05_3000 <-
  confint(mod1_05_3000)
```

### All scales CI Table

```{r}
#100 m:
ci_mod1_05_100 <-
  ci_mod1_05_100 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_05_100 <- ci_mod1_05_100 %>% rownames_to_column(var = "term")

citable_05_100 <-
  ci_mod1_05_100 %>%
  rename(
    "Estimate_100" = "Estimate",
    "CI_100_2.5" = "2.5 %",
    "CI_100_97.5" = "97.5 %")

#250 m:
ci_mod1_05_250 <-
  ci_mod1_05_250 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_05_250 <- ci_mod1_05_250 %>% rownames_to_column(var = "term")

citable_05_250 <-
  ci_mod1_05_250 %>%
  rename(
    "Estimate_250" = "Estimate",
    "CI_250_2.5" = "2.5 %",
    "CI_250_97.5" = "97.5 %")

#500 m:
ci_mod1_05_500 <-
  ci_mod1_05_500 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_05_500 <- ci_mod1_05_500 %>% rownames_to_column(var = "term")

citable_05_500 <-
  ci_mod1_05_500 %>%
  rename(
    "Estimate_500" = "Estimate",
    "CI_500_2.5" = "2.5 %",
    "CI_500_97.5" = "97.5 %")

#1000 m:
ci_mod1_05_1000 <-
  ci_mod1_05_1000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_05_1000 <- ci_mod1_05_1000 %>% rownames_to_column(var = "term")

citable_05_1000 <-
  ci_mod1_05_1000 %>%
  rename(
    "Estimate_1000" = "Estimate",
    "CI_1000_2.5" = "2.5 %",
    "CI_1000_97.5" = "97.5 %")

#2000 m:
ci_mod1_05_2000 <-
  ci_mod1_05_2000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_05_2000 <- ci_mod1_05_2000 %>% rownames_to_column(var = "term")

citable_05_2000 <-
  ci_mod1_05_2000 %>%
  rename(
    "Estimate_2000" = "Estimate",
    "CI_2000_2.5" = "2.5 %",
         "CI_2000_97.5" = "97.5 %")

#3000 m:
ci_mod1_05_3000 <-
  ci_mod1_05_3000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_05_3000 <- ci_mod1_05_3000 %>% rownames_to_column(var = "term")

citable_05_3000 <-
  ci_mod1_05_3000 %>%
  rename(
    "Estimate_3000" = "Estimate",
    "CI_3000_2.5" = "2.5 %",
         "CI_3000_97.5" = "97.5 %")

#All scales:
citable_05 <- full_join(citable_05_100,
                        citable_05_250,
                        by = c("term", "model"))
citable_05 <- full_join(citable_05,
                        citable_05_500,
                        by = c("term", "model"))
citable_05 <- full_join(citable_05,
                        citable_05_1000,
                        by = c("term", "model"))
citable_05 <- full_join(citable_05,
                        citable_05_2000,
                        by = c("term", "model"))
citable_05 <- full_join(citable_05,
                        citable_05_3000,
                        by = c("term", "model"))

citable_05 <- citable_05 %>%
  filter(!grepl('.sig|(Intercept)', term))

write.csv(citable_05, "~/Desktop/clim_land_arthropods/citable_05.csv")
```



## 06. Diet specialist pollinators (ts_poll_03_abund, Pollinator_study)

### Data frames

100 m:
```{r}
climate_land_abund_06_100 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_03_abund,
    sampling_effort_scaled,
    semifor_100,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_06 = ts_poll_03_abund,
    semifor_l = semifor_100
  )
```

250 m:
```{r}
climate_land_abund_06_250 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_03_abund,
    sampling_effort_scaled,
    semifor_250,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_06 = ts_poll_03_abund,
    semifor_l = semifor_250
  )
```

500 m:
```{r}
climate_land_abund_06_500 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_03_abund,
    sampling_effort_scaled,
    semifor_500,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_06 = ts_poll_03_abund,
    semifor_l = semifor_500
  )
```

1000 m:
```{r}
climate_land_abund_06_1000 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_03_abund,
    sampling_effort_scaled,
    semifor_1000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_06 = ts_poll_03_abund,
    semifor_l = semifor_1000
  )
```

2000 m:
```{r}
climate_land_abund_06_2000 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_03_abund,
    sampling_effort_scaled,
    semifor_2000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_06 = ts_poll_03_abund,
    semifor_l = semifor_2000
  )
```

3000 m:
```{r}
climate_land_abund_06_3000 <-
  climate_land_abund %>%
  filter(Pollinator_study == 1) %>%
  dplyr::select(
    ts_poll_03_abund,
    sampling_effort_scaled,
    semifor_3000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_06 = ts_poll_03_abund,
    semifor_l = semifor_3000
  )
```

### Models

#### 100 m
```{r}
mod1_06_100 <- glmmTMB(
  abund_06 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_06_100,
  na.action = "na.fail"
)
check_singularity(mod1_06_100)
check_collinearity(mod1_06_100)
summary(mod1_06_100)
```

#### 250 m
```{r}
mod1_06_250 <- glmmTMB(
  abund_06 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_06_250,
  na.action = "na.fail"
)
check_singularity(mod1_06_250)
check_collinearity(mod1_06_250)
summary(mod1_06_250)
modnull_06_250 <- glmmTMB(
  abund_06 ~
    1 + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_06_250,
  na.action = "na.fail"
)
model.sel(mod1_06_250, modnull_06_250)
```

#### 500 m
```{r}
mod1_06_500 <- glmmTMB(
  abund_06 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_06_500,
  na.action = "na.fail"
)
check_singularity(mod1_06_500)
check_collinearity(mod1_06_500)
summary(mod1_06_500)
```

#### 1000 m
```{r}
mod1_06_1000 <- glmmTMB(
  abund_06 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_06_1000,
  na.action = "na.fail"
)
check_singularity(mod1_06_1000)
check_collinearity(mod1_06_1000)
summary(mod1_06_1000)
```


#### 2000 m
```{r}
mod1_06_2000 <- glmmTMB(
  abund_06 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_06_2000,
  na.action = "na.fail"
)
check_singularity(mod1_06_2000)
check_collinearity(mod1_06_2000)
summary(mod1_06_2000)
```

#### 3000 m
```{r}
mod1_06_3000 <- glmmTMB(
  abund_06 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_06_3000,
  na.action = "na.fail"
)
check_singularity(mod1_06_3000)
check_collinearity(mod1_06_3000)
summary(mod1_06_3000)
```

### Confidence intervals

```{r}
#100 m:
ci_mod1_06_100 <-
  confint(mod1_06_100)

#250 m:
ci_mod1_06_250 <-
  confint(mod1_06_250)

#500 m:
ci_mod1_06_500 <-
  confint(mod1_06_500)

#1000 m:
ci_mod1_06_1000 <-
  confint(mod1_06_1000)

#2000 m:
ci_mod1_06_2000 <-
  confint(mod1_06_2000)

#3000 m:
ci_mod1_06_3000 <-
  confint(mod1_06_3000)
```

### All scales CI Table

```{r}
#100 m:
ci_mod1_06_100 <-
  ci_mod1_06_100 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_06_100 <- ci_mod1_06_100 %>% rownames_to_column(var = "term")

citable_06_100 <-
  ci_mod1_06_100 %>%
  rename(
    "Estimate_100" = "Estimate",
    "CI_100_2.5" = "2.5 %",
    "CI_100_97.5" = "97.5 %")

#250 m:
ci_mod1_06_250 <-
  ci_mod1_06_250 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_06_250 <- ci_mod1_06_250 %>% rownames_to_column(var = "term")

citable_06_250 <-
  ci_mod1_06_250 %>%
  rename(
    "Estimate_250" = "Estimate",
    "CI_250_2.5" = "2.5 %",
    "CI_250_97.5" = "97.5 %")

#500 m:
ci_mod1_06_500 <-
  ci_mod1_06_500 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_06_500 <- ci_mod1_06_500 %>% rownames_to_column(var = "term")

citable_06_500 <-
  ci_mod1_06_500 %>%
  rename(
    "Estimate_500" = "Estimate",
    "CI_500_2.5" = "2.5 %",
    "CI_500_97.5" = "97.5 %")

#1000 m:
ci_mod1_06_1000 <-
  ci_mod1_06_1000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_06_1000 <- ci_mod1_06_1000 %>% rownames_to_column(var = "term")

citable_06_1000 <-
  ci_mod1_06_1000 %>%
  rename(
    "Estimate_1000" = "Estimate",
    "CI_1000_2.5" = "2.5 %",
    "CI_1000_97.5" = "97.5 %")

#2000 m:
ci_mod1_06_2000 <-
  ci_mod1_06_2000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_06_2000 <- ci_mod1_06_2000 %>% rownames_to_column(var = "term")

citable_06_2000 <-
  ci_mod1_06_2000 %>%
  rename(
    "Estimate_2000" = "Estimate",
    "CI_2000_2.5" = "2.5 %",
         "CI_2000_97.5" = "97.5 %")

#3000 m:
ci_mod1_06_3000 <-
  ci_mod1_06_3000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_06_3000 <- ci_mod1_06_3000 %>% rownames_to_column(var = "term")

citable_06_3000 <-
  ci_mod1_06_3000 %>%
  rename(
    "Estimate_3000" = "Estimate",
    "CI_3000_2.5" = "2.5 %",
         "CI_3000_97.5" = "97.5 %")

#All scales:
citable_06 <- full_join(citable_06_100,
                        citable_06_250,
                        by = c("term", "model"))
citable_06 <- full_join(citable_06,
                        citable_06_500,
                        by = c("term", "model"))
citable_06 <- full_join(citable_06,
                        citable_06_1000,
                        by = c("term", "model"))
citable_06 <- full_join(citable_06,
                        citable_06_2000,
                        by = c("term", "model"))
citable_06 <- full_join(citable_06,
                        citable_06_3000,
                        by = c("term", "model"))

citable_06 <- citable_06 %>%
  filter(!grepl('.sig|(Intercept)', term))

write.csv(citable_06, "~/Desktop/clim_land_arthropods/citable_06.csv")
```


## 07. Habitat generalist pests (ts_pest_06_abund, Pest_study)

### Data frames

100 m:
```{r}
climate_land_abund_07_100 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_06_abund,
    sampling_effort_scaled,
    semifor_100,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_07 = ts_pest_06_abund,
    semifor_l = semifor_100
  )
```

250 m:
```{r}
climate_land_abund_07_250 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_06_abund,
    sampling_effort_scaled,
    semifor_250,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_07 = ts_pest_06_abund,
    semifor_l = semifor_250
  )
```

500 m:
```{r}
climate_land_abund_07_500 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_06_abund,
    sampling_effort_scaled,
    semifor_500,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_07 = ts_pest_06_abund,
    semifor_l = semifor_500
  )
```

1000 m:
```{r}
climate_land_abund_07_1000 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_06_abund,
    sampling_effort_scaled,
    semifor_1000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_07 = ts_pest_06_abund,
    semifor_l = semifor_1000
  )
```

2000 m:
```{r}
climate_land_abund_07_2000 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_06_abund,
    sampling_effort_scaled,
    semifor_2000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_07 = ts_pest_06_abund,
    semifor_l = semifor_2000
  )
```

3000 m:
```{r}
climate_land_abund_07_3000 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_06_abund,
    sampling_effort_scaled,
    semifor_3000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_07 = ts_pest_06_abund,
    semifor_l = semifor_3000
  )
```

### Models

#### 100 m
```{r}
mod1_07_100 <- glmmTMB(
  abund_07 ~
    scale(semifor_l) +  scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_07_100,
  na.action = "na.fail"
)
check_singularity(mod1_07_100)
check_collinearity(mod1_07_100)
summary(mod1_07_100)
```

#### 250 m
```{r}
mod1_07_250 <- glmmTMB(
  abund_07 ~
    scale(semifor_l) +  scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_07_250,
  na.action = "na.fail"
)
check_singularity(mod1_07_250)
check_collinearity(mod1_07_250)
summary(mod1_07_250)
```

#### 500 m
```{r}
mod1_07_500 <- glmmTMB(
  abund_07 ~
    scale(semifor_l) +  scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_07_500,
  na.action = "na.fail"
)
check_singularity(mod1_07_500)
check_collinearity(mod1_07_500)
summary(mod1_07_500)
modnull_07_500 <- glmmTMB(
  abund_07 ~
   1 + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_07_500,
  na.action = "na.fail"
)
model.sel(mod1_07_500, modnull_07_500)
```

#### 1000 m
```{r}
mod1_07_1000 <- glmmTMB(
  abund_07 ~
    scale(semifor_l) +  scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_07_1000,
  na.action = "na.fail"
)
check_singularity(mod1_07_1000)
check_collinearity(mod1_07_1000)
summary(mod1_07_1000)
```


#### 2000 m
```{r}
mod1_07_2000 <- glmmTMB(
  abund_07 ~
    scale(semifor_l) +  scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_07_2000,
  na.action = "na.fail"
)
check_singularity(mod1_07_2000)
check_collinearity(mod1_07_2000)
summary(mod1_07_2000)
```

#### 3000 m
```{r}
mod1_07_3000 <- glmmTMB(
  abund_07 ~
    scale(semifor_l) +  scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_07_3000,
  na.action = "na.fail"
)
check_singularity(mod1_07_3000)
check_collinearity(mod1_07_3000)
summary(mod1_07_3000)
```

### Confidence intervals

```{r}
#100 m:
ci_mod1_07_100 <-
  confint(mod1_07_100)

#250 m:
ci_mod1_07_250 <-
  confint(mod1_07_250)

#500 m:
ci_mod1_07_500 <-
  confint(mod1_07_500)

#1000 m:
ci_mod1_07_1000 <-
  confint(mod1_07_1000)

#2000 m:
ci_mod1_07_2000 <-
  confint(mod1_07_2000)

#3000 m:
ci_mod1_07_3000 <-
  confint(mod1_07_3000)
```

### All scales CI Table

```{r}
#100 m:
ci_mod1_07_100 <-
  ci_mod1_07_100 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_07_100 <- ci_mod1_07_100 %>% rownames_to_column(var = "term")

citable_07_100 <-
  ci_mod1_07_100 %>%
  rename(
    "Estimate_100" = "Estimate",
    "CI_100_2.5" = "2.5 %",
    "CI_100_97.5" = "97.5 %")

#250 m:
ci_mod1_07_250 <-
  ci_mod1_07_250 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_07_250 <- ci_mod1_07_250 %>% rownames_to_column(var = "term")

citable_07_250 <-
  ci_mod1_07_250 %>%
  rename(
    "Estimate_250" = "Estimate",
    "CI_250_2.5" = "2.5 %",
    "CI_250_97.5" = "97.5 %")

#500 m:
ci_mod1_07_500 <-
  ci_mod1_07_500 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_07_500 <- ci_mod1_07_500 %>% rownames_to_column(var = "term")

citable_07_500 <-
  ci_mod1_07_500 %>%
  rename(
    "Estimate_500" = "Estimate",
    "CI_500_2.5" = "2.5 %",
    "CI_500_97.5" = "97.5 %")

#1000 m:
ci_mod1_07_1000 <-
  ci_mod1_07_1000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_07_1000 <- ci_mod1_07_1000 %>% rownames_to_column(var = "term")

citable_07_1000 <-
  ci_mod1_07_1000 %>%
  rename(
    "Estimate_1000" = "Estimate",
    "CI_1000_2.5" = "2.5 %",
    "CI_1000_97.5" = "97.5 %")

#2000 m:
ci_mod1_07_2000 <-
  ci_mod1_07_2000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_07_2000 <- ci_mod1_07_2000 %>% rownames_to_column(var = "term")

citable_07_2000 <-
  ci_mod1_07_2000 %>%
  rename(
    "Estimate_2000" = "Estimate",
    "CI_2000_2.5" = "2.5 %",
         "CI_2000_97.5" = "97.5 %")

#3000 m:
ci_mod1_07_3000 <-
  ci_mod1_07_3000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_07_3000 <- ci_mod1_07_3000 %>% rownames_to_column(var = "term")

citable_07_3000 <-
  ci_mod1_07_3000 %>%
  rename(
    "Estimate_3000" = "Estimate",
    "CI_3000_2.5" = "2.5 %",
         "CI_3000_97.5" = "97.5 %")

#All scales:
citable_07 <- full_join(citable_07_100,
                        citable_07_250,
                        by = c("term", "model"))
citable_07 <- full_join(citable_07,
                        citable_07_500,
                        by = c("term", "model"))
citable_07 <- full_join(citable_07,
                        citable_07_1000,
                        by = c("term", "model"))
citable_07 <- full_join(citable_07,
                        citable_07_2000,
                        by = c("term", "model"))
citable_07 <- full_join(citable_07,
                        citable_07_3000,
                        by = c("term", "model"))

citable_07 <- citable_07 %>%
  filter(!grepl('.sig|(Intercept)', term))

write.csv(citable_07, "~/Desktop/clim_land_arthropods/citable_07.csv")
```



## 08. Habitat specialist pests (ts_pest_05_abund, Pest_study)

### Data frames

100 m:
```{r}
climate_land_abund_08_100 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_05_abund,
    sampling_effort_scaled,
    semifor_100,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_08 = ts_pest_05_abund,
    semifor_l = semifor_100
  )
```

250 m:
```{r}
climate_land_abund_08_250 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_05_abund,
    sampling_effort_scaled,
    semifor_250,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_08 = ts_pest_05_abund,
    semifor_l = semifor_250
  )
```

500 m:
```{r}
climate_land_abund_08_500 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_05_abund,
    sampling_effort_scaled,
    semifor_500,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_08 = ts_pest_05_abund,
    semifor_l = semifor_500
  )
```

1000 m:
```{r}
climate_land_abund_08_1000 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_05_abund,
    sampling_effort_scaled,
    semifor_1000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_08 = ts_pest_05_abund,
    semifor_l = semifor_1000
  )
```

2000 m:
```{r}
climate_land_abund_08_2000 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_05_abund,
    sampling_effort_scaled,
    semifor_2000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_08 = ts_pest_05_abund,
    semifor_l = semifor_2000
  )
```

3000 m:
```{r}
climate_land_abund_08_3000 <-
  climate_land_abund %>%
  filter(Pest_study == 1) %>%
  dplyr::select(
    ts_pest_05_abund,
    sampling_effort_scaled,
    semifor_3000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_08 = ts_pest_05_abund,
    semifor_l = semifor_3000
  )
```

### Models

#### 100 m
```{r}
mod1_08_100 <- glmmTMB(
  abund_08 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_08_100,
  na.action = "na.fail"
)
check_singularity(mod1_08_100)
check_collinearity(mod1_08_100)
summary(mod1_08_100)
```

#### 250 m
```{r}
mod1_08_250 <- glmmTMB(
  abund_08 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_08_250,
  na.action = "na.fail"
)
check_singularity(mod1_08_250)
check_collinearity(mod1_08_250)
summary(mod1_08_250)
```

#### 500 m
```{r}
mod1_08_500 <- glmmTMB(
  abund_08 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_08_500,
  na.action = "na.fail"
)
check_singularity(mod1_08_500)
check_collinearity(mod1_08_500)
summary(mod1_08_500)
modnull_08_500 <- glmmTMB(
  abund_08 ~
    1 + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_08_500,
  na.action = "na.fail"
)
model.sel(mod1_08_500, modnull_08_500)
```

#### 1000 m
```{r}
mod1_08_1000 <- glmmTMB(
  abund_08 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_08_1000,
  na.action = "na.fail"
)
check_singularity(mod1_08_1000)
check_collinearity(mod1_08_1000)
summary(mod1_08_1000)
```


#### 2000 m

excluded due to singular fit
```{r}
mod1_08_2000 <- glmmTMB(
  abund_08 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_08_2000,
  na.action = "na.fail"
)
check_singularity(mod1_08_2000)
check_collinearity(mod1_08_2000)
summary(mod1_08_2000)
```

#### 3000 m
excluded due to singular fit
```{r}
mod1_08_3000 <- glmmTMB(
  abund_08 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_08_3000,
  na.action = "na.fail"
)
check_singularity(mod1_08_3000)
check_collinearity(mod1_08_3000)
summary(mod1_08_3000)
```

### Confidence intervals

```{r}
#100 m:
ci_mod1_08_100 <-
  confint(mod1_08_100)

#250 m:
ci_mod1_08_250 <-
  confint(mod1_08_250)

#500 m:
ci_mod1_08_500 <-
  confint(mod1_08_500)

#1000 m:
ci_mod1_08_1000 <-
  confint(mod1_08_1000)

#2000 m:
ci_mod1_08_2000 <-
  confint(mod1_08_2000)

#3000 m:
ci_mod1_08_3000 <-
  confint(mod1_08_3000)
```

### All scales CI Table

```{r}
#100 m:
ci_mod1_08_100 <-
  ci_mod1_08_100 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_08_100 <- ci_mod1_08_100 %>% rownames_to_column(var = "term")

citable_08_100 <-
  ci_mod1_08_100 %>%
  rename(
    "Estimate_100" = "Estimate",
    "CI_100_2.5" = "2.5 %",
    "CI_100_97.5" = "97.5 %")

#250 m:
ci_mod1_08_250 <-
  ci_mod1_08_250 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_08_250 <- ci_mod1_08_250 %>% rownames_to_column(var = "term")

citable_08_250 <-
  ci_mod1_08_250 %>%
  rename(
    "Estimate_250" = "Estimate",
    "CI_250_2.5" = "2.5 %",
    "CI_250_97.5" = "97.5 %")

#500 m:
ci_mod1_08_500 <-
  ci_mod1_08_500 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_08_500 <- ci_mod1_08_500 %>% rownames_to_column(var = "term")

citable_08_500 <-
  ci_mod1_08_500 %>%
  rename(
    "Estimate_500" = "Estimate",
    "CI_500_2.5" = "2.5 %",
    "CI_500_97.5" = "97.5 %")

#1000 m:
ci_mod1_08_1000 <-
  ci_mod1_08_1000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_08_1000 <- ci_mod1_08_1000 %>% rownames_to_column(var = "term")

citable_08_1000 <-
  ci_mod1_08_1000 %>%
  rename(
    "Estimate_1000" = "Estimate",
    "CI_1000_2.5" = "2.5 %",
    "CI_1000_97.5" = "97.5 %")

#2000 m:
ci_mod1_08_2000 <-
  ci_mod1_08_2000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_08_2000 <- ci_mod1_08_2000 %>% rownames_to_column(var = "term")

citable_08_2000 <-
  ci_mod1_08_2000 %>%
  rename(
    "Estimate_2000" = "Estimate",
    "CI_2000_2.5" = "2.5 %",
         "CI_2000_97.5" = "97.5 %")

#3000 m:
ci_mod1_08_3000 <-
  ci_mod1_08_3000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_08_3000 <- ci_mod1_08_3000 %>% rownames_to_column(var = "term")

citable_08_3000 <-
  ci_mod1_08_3000 %>%
  rename(
    "Estimate_3000" = "Estimate",
    "CI_3000_2.5" = "2.5 %",
         "CI_3000_97.5" = "97.5 %")

#All scales:
citable_08 <- full_join(citable_08_100,
                        citable_08_250,
                        by = c("term", "model"))
citable_08 <- full_join(citable_08,
                        citable_08_500,
                        by = c("term", "model"))
citable_08 <- full_join(citable_08,
                        citable_08_1000,
                        by = c("term", "model"))
citable_08 <- full_join(citable_08,
                        citable_08_2000,
                        by = c("term", "model"))
citable_08 <- full_join(citable_08,
                        citable_08_3000,
                        by = c("term", "model"))

citable_08 <- citable_08 %>%
  filter(!grepl('.sig|(Intercept)', term))

write.csv(citable_08, "~/Desktop/clim_land_arthropods/citable_08.csv")
```


## 09. Habitat generalist, flight natural enemies (ts_nat_enemy_02_abund, Nat_enemy_study)

### Data frames

100 m:
```{r}
climate_land_abund_09_100 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_02_abund,
    sampling_effort_scaled,
    semifor_100,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_09 = ts_nat_enemy_02_abund,
    semifor_l = semifor_100
  )
```

250 m:
```{r}
climate_land_abund_09_250 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_02_abund,
    sampling_effort_scaled,
    semifor_250,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_09 = ts_nat_enemy_02_abund,
    semifor_l = semifor_250
  )
```

500 m:
```{r}
climate_land_abund_09_500 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_02_abund,
    sampling_effort_scaled,
    semifor_500,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_09 = ts_nat_enemy_02_abund,
    semifor_l = semifor_500
  )
```

1000 m:
```{r}
climate_land_abund_09_1000 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_02_abund,
    sampling_effort_scaled,
    semifor_1000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_09 = ts_nat_enemy_02_abund,
    semifor_l = semifor_1000
  )
```

2000 m:
```{r}
climate_land_abund_09_2000 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_02_abund,
    sampling_effort_scaled,
    semifor_2000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_09 = ts_nat_enemy_02_abund,
    semifor_l = semifor_2000
  )
```

3000 m:
```{r}
climate_land_abund_09_3000 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_02_abund,
    sampling_effort_scaled,
    semifor_3000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_09 = ts_nat_enemy_02_abund,
    semifor_l = semifor_3000
  )
```

### Models

#### 100 m
```{r}
mod1_09_100 <- glmmTMB(
  abund_09 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_09_100,
  na.action = "na.fail"
)
check_singularity(mod1_09_100)
check_collinearity(mod1_09_100)
summary(mod1_09_100)
```

#### 250 m
```{r}
mod1_09_250 <- glmmTMB(
  abund_09 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_09_250,
  na.action = "na.fail"
)
check_singularity(mod1_09_250)
check_collinearity(mod1_09_250)
summary(mod1_09_250)
```

#### 500 m
```{r}
mod1_09_500 <- glmmTMB(
  abund_09 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_09_500,
  na.action = "na.fail"
)
check_singularity(mod1_09_500)
check_collinearity(mod1_09_500)
summary(mod1_09_500)
modnull_09_500 <- glmmTMB(
  abund_09 ~
    1 + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_09_500,
  na.action = "na.fail"
)
model.sel(mod1_09_500, modnull_09_500)
```

#### 1000 m
```{r}
mod1_09_1000 <- glmmTMB(
  abund_09 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_09_1000,
  na.action = "na.fail"
)
check_singularity(mod1_09_1000)
check_collinearity(mod1_09_1000)
summary(mod1_09_1000)
```


#### 2000 m

excluded due to singular fit
```{r}
mod1_09_2000 <- glmmTMB(
  abund_09 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_09_2000,
  na.action = "na.fail"
)
check_singularity(mod1_09_2000)
check_collinearity(mod1_09_2000)
summary(mod1_09_2000)
```

#### 3000 m
excluded due to singular fit
```{r}
mod1_09_3000 <- glmmTMB(
  abund_09 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_09_3000,
  na.action = "na.fail"
)
check_singularity(mod1_09_3000)
# check_collinearity(mod1_09_3000)
summary(mod1_09_3000)
```

### Confidence intervals

```{r}
#100 m:
ci_mod1_09_100 <-
  confint(mod1_09_100)

#250 m:
ci_mod1_09_250 <-
  confint(mod1_09_250)

#500 m:
ci_mod1_09_500 <-
  confint(mod1_09_500)

#1000 m:
ci_mod1_09_1000 <-
  confint(mod1_09_1000)

#2000 m:
ci_mod1_09_2000 <-
  confint(mod1_09_2000)

#3000 m:
ci_mod1_09_3000 <-
  confint(mod1_09_3000)
```

### All scales CI Table

```{r}
#100 m:
ci_mod1_09_100 <-
  ci_mod1_09_100 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_09_100 <- ci_mod1_09_100 %>% rownames_to_column(var = "term")

citable_09_100 <-
  ci_mod1_09_100 %>%
  rename(
    "Estimate_100" = "Estimate",
    "CI_100_2.5" = "2.5 %",
    "CI_100_97.5" = "97.5 %")

#250 m:
ci_mod1_09_250 <-
  ci_mod1_09_250 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_09_250 <- ci_mod1_09_250 %>% rownames_to_column(var = "term")

citable_09_250 <-
  ci_mod1_09_250 %>%
  rename(
    "Estimate_250" = "Estimate",
    "CI_250_2.5" = "2.5 %",
    "CI_250_97.5" = "97.5 %")

#500 m:
ci_mod1_09_500 <-
  ci_mod1_09_500 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_09_500 <- ci_mod1_09_500 %>% rownames_to_column(var = "term")

citable_09_500 <-
  ci_mod1_09_500 %>%
  rename(
    "Estimate_500" = "Estimate",
    "CI_500_2.5" = "2.5 %",
    "CI_500_97.5" = "97.5 %")

#1000 m:
ci_mod1_09_1000 <-
  ci_mod1_09_1000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_09_1000 <- ci_mod1_09_1000 %>% rownames_to_column(var = "term")

citable_09_1000 <-
  ci_mod1_09_1000 %>%
  rename(
    "Estimate_1000" = "Estimate",
    "CI_1000_2.5" = "2.5 %",
    "CI_1000_97.5" = "97.5 %")

#2000 m:
ci_mod1_09_2000 <-
  ci_mod1_09_2000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_09_2000 <- ci_mod1_09_2000 %>% rownames_to_column(var = "term")

citable_09_2000 <-
  ci_mod1_09_2000 %>%
  rename(
    "Estimate_2000" = "Estimate",
    "CI_2000_2.5" = "2.5 %",
         "CI_2000_97.5" = "97.5 %")

#3000 m:
ci_mod1_09_3000 <-
  ci_mod1_09_3000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_09_3000 <- ci_mod1_09_3000 %>% rownames_to_column(var = "term")

citable_09_3000 <-
  ci_mod1_09_3000 %>%
  rename(
    "Estimate_3000" = "Estimate",
    "CI_3000_2.5" = "2.5 %",
         "CI_3000_97.5" = "97.5 %")

#All scales:
citable_09 <- full_join(citable_09_100,
                        citable_09_250,
                        by = c("term", "model"))
citable_09 <- full_join(citable_09,
                        citable_09_500,
                        by = c("term", "model"))
citable_09 <- full_join(citable_09,
                        citable_09_1000,
                        by = c("term", "model"))
citable_09 <- full_join(citable_09,
                        citable_09_2000,
                        by = c("term", "model"))
citable_09 <- full_join(citable_09,
                        citable_09_3000,
                        by = c("term", "model"))

citable_09 <- citable_09 %>%
  filter(!grepl('.sig|(Intercept)', term))

write.csv(citable_09, "~/Desktop/clim_land_arthropods/citable_09.csv")
```


## 10. Habitat specialist, ground pests (ts_nat_enemy_03_abund, Nat_enemy_study)

### Data frames

100 m:
```{r}
climate_land_abund_10_100 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_03_abund,
    sampling_effort_scaled,
    semifor_100,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_10 = ts_nat_enemy_03_abund,
    semifor_l = semifor_100
  )
```

250 m:
```{r}
climate_land_abund_10_250 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_03_abund,
    sampling_effort_scaled,
    semifor_250,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_10 = ts_nat_enemy_03_abund,
    semifor_l = semifor_250
  )
```

500 m:
```{r}
climate_land_abund_10_500 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_03_abund,
    sampling_effort_scaled,
    semifor_500,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_10 = ts_nat_enemy_03_abund,
    semifor_l = semifor_500
  )
```

1000 m:
```{r}
climate_land_abund_10_1000 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_03_abund,
    sampling_effort_scaled,
    semifor_1000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_10 = ts_nat_enemy_03_abund,
    semifor_l = semifor_1000
  )
```

2000 m:
```{r}
climate_land_abund_10_2000 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_03_abund,
    sampling_effort_scaled,
    semifor_2000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_10 = ts_nat_enemy_03_abund,
    semifor_l = semifor_2000
  )
```

3000 m:
```{r}
climate_land_abund_10_3000 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_03_abund,
    sampling_effort_scaled,
    semifor_3000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_10 = ts_nat_enemy_03_abund,
    semifor_l = semifor_3000
  )
```

### Models

#### 100 m
```{r}
mod1_10_100 <- glmmTMB(
  abund_10 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_10_100,
  na.action = "na.fail"
)
check_singularity(mod1_10_100)
check_collinearity(mod1_10_100)
summary(mod1_10_100)
```

#### 250 m
```{r}
mod1_10_250 <- glmmTMB(
  abund_10 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_10_250,
  na.action = "na.fail"
)
check_singularity(mod1_10_250)
check_collinearity(mod1_10_250)
summary(mod1_10_250)
```

#### 500 m
```{r}
mod1_10_500 <- glmmTMB(
  abund_10 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_10_500,
  na.action = "na.fail"
)
check_singularity(mod1_10_500)
check_collinearity(mod1_10_500)
summary(mod1_10_500)
modnull_10_500 <- glmmTMB(
  abund_10 ~
    1 + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_10_500,
  na.action = "na.fail"
)
model.sel(mod1_10_500, modnull_10_500)
```

#### 1000 m
```{r}
mod1_10_1000 <- glmmTMB(
  abund_10 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_10_1000,
  na.action = "na.fail"
)
check_singularity(mod1_10_1000)
check_collinearity(mod1_10_1000)
summary(mod1_10_1000)
```


#### 2000 m
```{r}
mod1_10_2000 <- glmmTMB(
  abund_10 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_10_2000,
  na.action = "na.fail"
)
check_singularity(mod1_10_2000)
check_collinearity(mod1_10_2000)
summary(mod1_10_2000)
```

#### 3000 m
```{r}
mod1_10_3000 <- glmmTMB(
  abund_10 ~
    scale(semifor_l) + scale(change3_MAT) + scale(change3_VAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_10_3000,
  na.action = "na.fail"
)
check_singularity(mod1_10_3000)
check_collinearity(mod1_10_3000)
summary(mod1_10_3000)
```

### Confidence intervals

```{r}
#100 m:
ci_mod1_10_100 <-
  confint(mod1_10_100)

#250 m:
ci_mod1_10_250 <-
  confint(mod1_10_250)

#500 m:
ci_mod1_10_500 <-
  confint(mod1_10_500)

#1000 m:
ci_mod1_10_1000 <-
  confint(mod1_10_1000)

#2000 m:
ci_mod1_10_2000 <-
  confint(mod1_10_2000)

#3000 m:
ci_mod1_10_3000 <-
  confint(mod1_10_3000)
```

### All scales CI Table

```{r}
#100 m:
ci_mod1_10_100 <-
  ci_mod1_10_100 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_10_100 <- ci_mod1_10_100 %>% rownames_to_column(var = "term")

citable_10_100 <-
  ci_mod1_10_100 %>%
  rename(
    "Estimate_100" = "Estimate",
    "CI_100_2.5" = "2.5 %",
    "CI_100_97.5" = "97.5 %")

#250 m:
ci_mod1_10_250 <-
  ci_mod1_10_250 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_10_250 <- ci_mod1_10_250 %>% rownames_to_column(var = "term")

citable_10_250 <-
  ci_mod1_10_250 %>%
  rename(
    "Estimate_250" = "Estimate",
    "CI_250_2.5" = "2.5 %",
    "CI_250_97.5" = "97.5 %")

#500 m:
ci_mod1_10_500 <-
  ci_mod1_10_500 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_10_500 <- ci_mod1_10_500 %>% rownames_to_column(var = "term")

citable_10_500 <-
  ci_mod1_10_500 %>%
  rename(
    "Estimate_500" = "Estimate",
    "CI_500_2.5" = "2.5 %",
    "CI_500_97.5" = "97.5 %")

#1000 m:
ci_mod1_10_1000 <-
  ci_mod1_10_1000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_10_1000 <- ci_mod1_10_1000 %>% rownames_to_column(var = "term")

citable_10_1000 <-
  ci_mod1_10_1000 %>%
  rename(
    "Estimate_1000" = "Estimate",
    "CI_1000_2.5" = "2.5 %",
    "CI_1000_97.5" = "97.5 %")

#2000 m:
ci_mod1_10_2000 <-
  ci_mod1_10_2000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_10_2000 <- ci_mod1_10_2000 %>% rownames_to_column(var = "term")

citable_10_2000 <-
  ci_mod1_10_2000 %>%
  rename(
    "Estimate_2000" = "Estimate",
    "CI_2000_2.5" = "2.5 %",
         "CI_2000_97.5" = "97.5 %")

#3000 m:
ci_mod1_10_3000 <-
  ci_mod1_10_3000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_10_3000 <- ci_mod1_10_3000 %>% rownames_to_column(var = "term")

citable_10_3000 <-
  ci_mod1_10_3000 %>%
  rename(
    "Estimate_3000" = "Estimate",
    "CI_3000_2.5" = "2.5 %",
         "CI_3000_97.5" = "97.5 %")

#All scales:
citable_10 <- full_join(citable_10_100,
                        citable_10_250,
                        by = c("term", "model"))
citable_10 <- full_join(citable_10,
                        citable_10_500,
                        by = c("term", "model"))
citable_10 <- full_join(citable_10,
                        citable_10_1000,
                        by = c("term", "model"))
citable_10 <- full_join(citable_10,
                        citable_10_2000,
                        by = c("term", "model"))
citable_10 <- full_join(citable_10,
                        citable_10_3000,
                        by = c("term", "model"))

citable_10 <- citable_10 %>%
  filter(!grepl('.sig|(Intercept)', term))

write.csv(citable_10, "~/Desktop/clim_land_arthropods/citable_10.csv")
```


## 11. Habitat generalist, ground pests (ts_nat_enemy_04_abund, Nat_enemy_study)

### Data frames

100 m:
```{r}
climate_land_abund_11_100 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_04_abund,
    sampling_effort_scaled,
    semifor_100,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_11 = ts_nat_enemy_04_abund,
    semifor_l = semifor_100
  )
```

250 m:
```{r}
climate_land_abund_11_250 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_04_abund,
    sampling_effort_scaled,
    semifor_250,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_11 = ts_nat_enemy_04_abund,
    semifor_l = semifor_250
  )
```

500 m:
```{r}
climate_land_abund_11_500 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_04_abund,
    sampling_effort_scaled,
    semifor_500,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_11 = ts_nat_enemy_04_abund,
    semifor_l = semifor_500
  )
```

1000 m:
```{r}
climate_land_abund_11_1000 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_04_abund,
    sampling_effort_scaled,
    semifor_1000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_11 = ts_nat_enemy_04_abund,
    semifor_l = semifor_1000
  )
```

2000 m:
```{r}
climate_land_abund_11_2000 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_04_abund,
    sampling_effort_scaled,
    semifor_2000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_11 = ts_nat_enemy_04_abund,
    semifor_l = semifor_2000
  )
```

3000 m:
```{r}
climate_land_abund_11_3000 <-
  climate_land_abund %>%
  filter(Nat_enemy_study == 1) %>%
  dplyr::select(
    ts_nat_enemy_04_abund,
    sampling_effort_scaled,
    semifor_3000,
    change3_MAT,
    change3_VAT,
    present3_MAT,
    present3_VAT,
    StudyID_yr,
    Sampling_method,
    Block,
    Latitude,
    Longitude
  ) %>%
  ungroup() %>%
  na.omit() %>%
  mutate(
    abund_11 = ts_nat_enemy_04_abund,
    semifor_l = semifor_3000
  )
```

### Models

#### 100 m
```{r}
mod1_11_100 <- glmmTMB(
  abund_11 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_11_100,
  na.action = "na.fail"
)
check_singularity(mod1_11_100)
check_collinearity(mod1_11_100)
summary(mod1_11_100)
```

#### 250 m
```{r}
mod1_11_250 <- glmmTMB(
  abund_11 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_11_250,
  na.action = "na.fail"
)
check_singularity(mod1_11_250)
check_collinearity(mod1_11_250)
summary(mod1_11_250)
```

#### 500 m
```{r}
mod1_11_500 <- glmmTMB(
  abund_11 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_11_500,
  na.action = "na.fail"
)
check_singularity(mod1_11_500)
check_collinearity(mod1_11_500)
summary(mod1_11_500)
modnull_11_500 <- glmmTMB(
  abund_11 ~
    1 + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_11_500,
  na.action = "na.fail"
)
model.sel(mod1_11_500, modnull_11_500)
```

#### 1000 m
```{r}
mod1_11_1000 <- glmmTMB(
  abund_11 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_11_1000,
  na.action = "na.fail"
)
check_singularity(mod1_11_1000)
check_collinearity(mod1_11_1000)
summary(mod1_11_1000)
```


#### 2000 m
```{r}
mod1_11_2000 <- glmmTMB(
  abund_11 ~
    scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
  family = ziGamma(link = "log"),
  ziformula = ~ 1,
  data = climate_land_abund_11_2000,
  na.action = "na.fail"
)
check_singularity(mod1_11_2000)
check_collinearity(mod1_11_2000)
summary(mod1_11_2000)
```

#### 3000 m
excluded due to singular fit
```{r}
# mod1_11_3000 <- glmmTMB(
#   abund_11 ~
#     scale(semifor_l) * scale(change3_VAT) + scale(change3_MAT) + (1 | StudyID_yr:Sampling_method) + offset(log(sampling_effort_scaled)),
#   family = ziGamma(link = "log"),
#   ziformula = ~ 1,
#   data = climate_land_abund_11_3000,
#   na.action = "na.fail"
# )
# check_singularity(mod1_11_3000)
# check_collinearity(mod1_11_3000)
# summary(mod1_11_3000)
```


### Confidence intervals

```{r}
#100 m:
ci_mod1_11_100 <-
  confint(mod1_11_100)

#250 m:
ci_mod1_11_250 <-
  confint(mod1_11_250)

#500 m:
ci_mod1_11_500 <-
  confint(mod1_11_500)

#1000 m:
ci_mod1_11_1000 <-
  confint(mod1_11_1000)

#2000 m:
ci_mod1_11_2000 <-
  confint(mod1_11_2000)

#3000 m:
# ci_mod1_11_3000 <-
#   confint(mod1_11_3000)
```

### All scales CI Table

```{r}
#100 m:
ci_mod1_11_100 <-
  ci_mod1_11_100 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_11_100 <- ci_mod1_11_100 %>% rownames_to_column(var = "term")

citable_11_100 <-
  ci_mod1_11_100 %>%
  rename(
    "Estimate_100" = "Estimate",
    "CI_100_2.5" = "2.5 %",
    "CI_100_97.5" = "97.5 %")

#250 m:
ci_mod1_11_250 <-
  ci_mod1_11_250 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_11_250 <- ci_mod1_11_250 %>% rownames_to_column(var = "term")

citable_11_250 <-
  ci_mod1_11_250 %>%
  rename(
    "Estimate_250" = "Estimate",
    "CI_250_2.5" = "2.5 %",
    "CI_250_97.5" = "97.5 %")

#500 m:
ci_mod1_11_500 <-
  ci_mod1_11_500 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_11_500 <- ci_mod1_11_500 %>% rownames_to_column(var = "term")

citable_11_500 <-
  ci_mod1_11_500 %>%
  rename(
    "Estimate_500" = "Estimate",
    "CI_500_2.5" = "2.5 %",
    "CI_500_97.5" = "97.5 %")

#1000 m:
ci_mod1_11_1000 <-
  ci_mod1_11_1000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_11_1000 <- ci_mod1_11_1000 %>% rownames_to_column(var = "term")

citable_11_1000 <-
  ci_mod1_11_1000 %>%
  rename(
    "Estimate_1000" = "Estimate",
    "CI_1000_2.5" = "2.5 %",
    "CI_1000_97.5" = "97.5 %")

#2000 m:
ci_mod1_11_2000 <-
  ci_mod1_11_2000 %>%
  as.data.frame() %>%
  mutate(model = "mod1")
ci_mod1_11_2000 <- ci_mod1_11_2000 %>% rownames_to_column(var = "term")

citable_11_2000 <-
  ci_mod1_11_2000 %>%
  rename(
    "Estimate_2000" = "Estimate",
    "CI_2000_2.5" = "2.5 %",
         "CI_2000_97.5" = "97.5 %")

#3000 m:
# ci_mod1_11_3000 <-
#   ci_mod1_11_3000 %>%
#   as.data.frame() %>%
#   mutate(model = "mod1")
# ci_mod1_11_3000 <- ci_mod1_11_3000 %>% rownames_to_column(var = "term")
# 
# citable_11_3000 <-
#   ci_mod1_11_3000 %>%
#   rename(
#     "Estimate_3000" = "Estimate",
#     "CI_3000_2.5" = "2.5 %",
#          "CI_3000_97.5" = "97.5 %")

#All scales:
citable_11 <- full_join(citable_11_100,
                        citable_11_250,
                        by = c("term", "model"))
citable_11 <- full_join(citable_11,
                        citable_11_500,
                        by = c("term", "model"))
citable_11 <- full_join(citable_11,
                        citable_11_1000,
                        by = c("term", "model"))
citable_11 <- full_join(citable_11,
                        citable_11_2000,
                        by = c("term", "model"))
# citable_11 <- full_join(citable_11,
#                         citable_11_3000,
#                         by = c("term", "model"))

citable_11 <- citable_11 %>%
  filter(!grepl('.sig|(Intercept)', term))

write.csv(citable_11, "~/Desktop/clim_land_arthropods/citable_11.csv")
```



# Correlograms

```{r}
library(ncf)
```

## 01. All arthropods

### mod1

100m:
```{r}
correlog_mod1_01_100 <-
  spline.correlog(
    x = climate_land_abund_01_100$Longitude,
    y = climate_land_abund_01_100$Latitude,
    z = residuals(mod1_01_100, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_01_100)
```

250m:
```{r}
correlog_mod1_01_250 <-
  spline.correlog(
    x = climate_land_abund_01_250$Longitude,
    y = climate_land_abund_01_250$Latitude,
    z = residuals(mod1_01_250, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_01_250)
```

500m:
```{r}
correlog_mod1_01_500 <-
  spline.correlog(
    x = climate_land_abund_01_500$Longitude,
    y = climate_land_abund_01_500$Latitude,
    z = residuals(mod1_01_500, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_01_500)
```

1000m:
```{r}
correlog_mod1_01_1000 <-
  spline.correlog(
    x = climate_land_abund_01_1000$Longitude,
    y = climate_land_abund_01_1000$Latitude,
    z = residuals(mod1_01_1000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_01_1000)
```

2000m:
```{r}
correlog_mod1_01_2000 <-
  spline.correlog(
    x = climate_land_abund_01_2000$Longitude,
    y = climate_land_abund_01_2000$Latitude,
    z = residuals(mod1_01_2000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_01_2000)
```

3000m:
```{r}
correlog_mod1_01_3000 <-
  spline.correlog(
    x = climate_land_abund_01_3000$Longitude,
    y = climate_land_abund_01_3000$Latitude,
    z = residuals(mod1_01_3000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_01_3000)
```

## 05. Diet generalist pollinators

### mod1

100m:
```{r}
correlog_mod1_05_100 <-
  spline.correlog(
    x = climate_land_abund_05_100$Longitude,
    y = climate_land_abund_05_100$Latitude,
    z = residuals(mod1_05_100, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_05_100)
```

250m:
```{r}
correlog_mod1_05_250 <-
  spline.correlog(
    x = climate_land_abund_05_250$Longitude,
    y = climate_land_abund_05_250$Latitude,
    z = residuals(mod1_05_250, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_05_250)
```

500m:
```{r}
correlog_mod1_05_500 <-
  spline.correlog(
    x = climate_land_abund_05_500$Longitude,
    y = climate_land_abund_05_500$Latitude,
    z = residuals(mod1_05_500, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_05_500)
```

1000m:
```{r}
correlog_mod1_05_1000 <-
  spline.correlog(
    x = climate_land_abund_05_1000$Longitude,
    y = climate_land_abund_05_1000$Latitude,
    z = residuals(mod1_05_1000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_05_1000)
```

2000m:
```{r}
correlog_mod1_05_2000 <-
  spline.correlog(
    x = climate_land_abund_05_2000$Longitude,
    y = climate_land_abund_05_2000$Latitude,
    z = residuals(mod1_05_2000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_05_2000)
```

3000m:
```{r}
correlog_mod1_05_3000 <-
  spline.correlog(
    x = climate_land_abund_05_3000$Longitude,
    y = climate_land_abund_05_3000$Latitude,
    z = residuals(mod1_05_3000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_05_3000)
```


## 06. Diet specialist pollinators

### mod1

100m:
```{r}
correlog_mod1_06_100 <-
  spline.correlog(
    x = climate_land_abund_06_100$Longitude,
    y = climate_land_abund_06_100$Latitude,
    z = residuals(mod1_06_100, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_06_100)
```

250m:
```{r}
correlog_mod1_06_250 <-
  spline.correlog(
    x = climate_land_abund_06_250$Longitude,
    y = climate_land_abund_06_250$Latitude,
    z = residuals(mod1_06_250, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_06_250)
```

500m:
```{r}
correlog_mod1_06_500 <-
  spline.correlog(
    x = climate_land_abund_06_500$Longitude,
    y = climate_land_abund_06_500$Latitude,
    z = residuals(mod1_06_500, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_06_500)
```

1000m:
```{r}
correlog_mod1_06_1000 <-
  spline.correlog(
    x = climate_land_abund_06_1000$Longitude,
    y = climate_land_abund_06_1000$Latitude,
    z = residuals(mod1_06_1000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_06_1000)
```

2000m:
```{r}
correlog_mod1_06_2000 <-
  spline.correlog(
    x = climate_land_abund_06_2000$Longitude,
    y = climate_land_abund_06_2000$Latitude,
    z = residuals(mod1_06_2000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_06_2000)
```

3000m:
```{r}
correlog_mod1_06_3000 <-
  spline.correlog(
    x = climate_land_abund_06_3000$Longitude,
    y = climate_land_abund_06_3000$Latitude,
    z = residuals(mod1_06_3000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_06_3000)
```


## 07. Habitat generalist pests

### mod1

100m:
```{r}
correlog_mod1_07_100 <-
  spline.correlog(
    x = climate_land_abund_07_100$Longitude,
    y = climate_land_abund_07_100$Latitude,
    z = residuals(mod1_07_100, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_07_100)
```

250m:
```{r}
correlog_mod1_07_250 <-
  spline.correlog(
    x = climate_land_abund_07_250$Longitude,
    y = climate_land_abund_07_250$Latitude,
    z = residuals(mod1_07_250, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_07_250)
```

500m:
```{r}
correlog_mod1_07_500 <-
  spline.correlog(
    x = climate_land_abund_07_500$Longitude,
    y = climate_land_abund_07_500$Latitude,
    z = residuals(mod1_07_500, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_07_500)
```

1000m:
```{r}
correlog_mod1_07_1000 <-
  spline.correlog(
    x = climate_land_abund_07_1000$Longitude,
    y = climate_land_abund_07_1000$Latitude,
    z = residuals(mod1_07_1000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_07_1000)
```

2000m:
```{r}
correlog_mod1_07_2000 <-
  spline.correlog(
    x = climate_land_abund_07_2000$Longitude,
    y = climate_land_abund_07_2000$Latitude,
    z = residuals(mod1_07_2000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_07_2000)
```

3000m:
```{r}
correlog_mod1_07_3000 <-
  spline.correlog(
    x = climate_land_abund_07_3000$Longitude,
    y = climate_land_abund_07_3000$Latitude,
    z = residuals(mod1_07_3000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_07_3000)
```


## 08. Habitat specialist pests

### mod1

100m:
```{r}
correlog_mod1_08_100 <-
  spline.correlog(
    x = climate_land_abund_08_100$Longitude,
    y = climate_land_abund_08_100$Latitude,
    z = residuals(mod1_08_100, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_08_100)
```

250m:
```{r}
correlog_mod1_08_250 <-
  spline.correlog(
    x = climate_land_abund_08_250$Longitude,
    y = climate_land_abund_08_250$Latitude,
    z = residuals(mod1_08_250, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_08_250)
```

500m:
```{r}
correlog_mod1_08_500 <-
  spline.correlog(
    x = climate_land_abund_08_500$Longitude,
    y = climate_land_abund_08_500$Latitude,
    z = residuals(mod1_08_500, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_08_500)
```

1000m:
```{r}
correlog_mod1_08_1000 <-
  spline.correlog(
    x = climate_land_abund_08_1000$Longitude,
    y = climate_land_abund_08_1000$Latitude,
    z = residuals(mod1_08_1000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_08_1000)
```

<!-- 2000m: -->
<!-- ```{r} -->
<!-- correlog_mod1_08_2000 <- -->
<!--   spline.correlog( -->
<!--     x = climate_land_abund_08_2000$Longitude, -->
<!--     y = climate_land_abund_08_2000$Latitude, -->
<!--     z = residuals(mod1_08_2000, type = "pearson"), -->
<!--     latlon = TRUE -->
<!--   ) -->
<!-- plot(correlog_mod1_08_2000) -->
<!-- ``` -->

<!-- 3000m: -->
<!-- ```{r} -->
<!-- correlog_mod1_08_3000 <- -->
<!--   spline.correlog( -->
<!--     x = climate_land_abund_08_3000$Longitude, -->
<!--     y = climate_land_abund_08_3000$Latitude, -->
<!--     z = residuals(mod1_08_3000, type = "pearson"), -->
<!--     latlon = TRUE -->
<!--   ) -->
<!-- plot(correlog_mod1_08_3000) -->
<!-- ``` -->


## 09. Habitat generalist, flight natural enemies
### mod1

100m:
```{r}
correlog_mod1_09_100 <-
  spline.correlog(
    x = climate_land_abund_09_100$Longitude,
    y = climate_land_abund_09_100$Latitude,
    z = residuals(mod1_09_100, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_09_100)
```

250m:
```{r}
correlog_mod1_09_250 <-
  spline.correlog(
    x = climate_land_abund_09_250$Longitude,
    y = climate_land_abund_09_250$Latitude,
    z = residuals(mod1_09_250, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_09_250)
```

500m:
```{r}
correlog_mod1_09_500 <-
  spline.correlog(
    x = climate_land_abund_09_500$Longitude,
    y = climate_land_abund_09_500$Latitude,
    z = residuals(mod1_09_500, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_09_500)
```

1000m:
```{r}
correlog_mod1_09_1000 <-
  spline.correlog(
    x = climate_land_abund_09_1000$Longitude,
    y = climate_land_abund_09_1000$Latitude,
    z = residuals(mod1_09_1000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_09_1000)
```

<!-- 2000m: -->
<!-- ```{r} -->
<!-- correlog_mod1_09_2000 <- -->
<!--   spline.correlog( -->
<!--     x = climate_land_abund_09_2000$Longitude, -->
<!--     y = climate_land_abund_09_2000$Latitude, -->
<!--     z = residuals(mod1_09_2000, type = "pearson"), -->
<!--     latlon = TRUE -->
<!--   ) -->
<!-- plot(correlog_mod1_09_2000) -->
<!-- ``` -->

<!-- 3000m: -->
<!-- ```{r} -->
<!-- correlog_mod1_09_3000 <- -->
<!--   spline.correlog( -->
<!--     x = climate_land_abund_09_3000$Longitude, -->
<!--     y = climate_land_abund_09_3000$Latitude, -->
<!--     z = residuals(mod1_09_3000, type = "pearson"), -->
<!--     latlon = TRUE -->
<!--   ) -->
<!-- plot(correlog_mod1_09_3000) -->
<!-- ``` -->


## 10. Habitat specialist, ground natural enemies
### mod1

100m:
```{r}
correlog_mod1_10_100 <-
  spline.correlog(
    x = climate_land_abund_10_100$Longitude,
    y = climate_land_abund_10_100$Latitude,
    z = residuals(mod1_10_100, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_10_100)
```

250m:
```{r}
correlog_mod1_10_250 <-
  spline.correlog(
    x = climate_land_abund_10_250$Longitude,
    y = climate_land_abund_10_250$Latitude,
    z = residuals(mod1_10_250, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_10_250)
```

500m:
```{r}
correlog_mod1_10_500 <-
  spline.correlog(
    x = climate_land_abund_10_500$Longitude,
    y = climate_land_abund_10_500$Latitude,
    z = residuals(mod1_10_500, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_10_500)
```

1000m:
```{r}
correlog_mod1_10_1000 <-
  spline.correlog(
    x = climate_land_abund_10_1000$Longitude,
    y = climate_land_abund_10_1000$Latitude,
    z = residuals(mod1_10_1000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_10_1000)
```

2000m:
```{r}
correlog_mod1_10_2000 <-
  spline.correlog(
    x = climate_land_abund_10_2000$Longitude,
    y = climate_land_abund_10_2000$Latitude,
    z = residuals(mod1_10_2000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_10_2000)
```

3000m:
```{r}
correlog_mod1_10_3000 <-
  spline.correlog(
    x = climate_land_abund_10_3000$Longitude,
    y = climate_land_abund_10_3000$Latitude,
    z = residuals(mod1_10_3000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_10_3000)
```


## 11. Habitat generalist, ground natural enemies

### mod1

100m:
```{r}
correlog_mod1_11_100 <-
  spline.correlog(
    x = climate_land_abund_11_100$Longitude,
    y = climate_land_abund_11_100$Latitude,
    z = residuals(mod1_11_100, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_11_100)
```

250m:
```{r}
correlog_mod1_11_250 <-
  spline.correlog(
    x = climate_land_abund_11_250$Longitude,
    y = climate_land_abund_11_250$Latitude,
    z = residuals(mod1_11_250, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_11_250)
```

500m:
```{r}
correlog_mod1_11_500 <-
  spline.correlog(
    x = climate_land_abund_11_500$Longitude,
    y = climate_land_abund_11_500$Latitude,
    z = residuals(mod1_11_500, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_11_500)
```

1000m:
```{r}
correlog_mod1_11_1000 <-
  spline.correlog(
    x = climate_land_abund_11_1000$Longitude,
    y = climate_land_abund_11_1000$Latitude,
    z = residuals(mod1_11_1000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_11_1000)
```

2000m:
```{r}
correlog_mod1_11_2000 <-
  spline.correlog(
    x = climate_land_abund_11_2000$Longitude,
    y = climate_land_abund_11_2000$Latitude,
    z = residuals(mod1_11_2000, type = "pearson"),
    latlon = TRUE
  )
plot(correlog_mod1_11_2000)
```

<!-- 3000m: -->
<!-- ```{r} -->
<!-- correlog_mod1_11_3000 <- -->
<!--   spline.correlog( -->
<!--     x = climate_land_abund_11_3000$Longitude, -->
<!--     y = climate_land_abund_11_3000$Latitude, -->
<!--     z = residuals(mod1_11_3000, type = "pearson"), -->
<!--     latlon = TRUE -->
<!--   ) -->
<!-- plot(correlog_mod1_11_3000) -->
<!-- ``` -->

